# 仙言

## 工作方式

> xn.exe <文件路径>

会生成output.cc文件，然后就可以使用cpp编译器编译

需要注意的是，C++版本应至少为C++17，并且开启优化，因为使用了一些神奇特性

## 语法

### 命令

由#开始的行

```c
# import io
```

#### 目前支持的命令

- import
  - io

### 注释

在命令中#网后的部分

```c
## 我是注释
# # 我也是注释
```

### 函数定义

函数定义由函数名、参数列表、函数体组成，返回值可选，不写返回值就是void

```c
dosomething():;

add(a: i32, b: i32) -> i32: return a + b;

add(a: i32, b: i32, c:&~i32): c = a + b;

mutiline():
    dosomething()
    dosomething()
    dosomething()
;
```

### 变量定义

变量定义由变量名、类型、值组成，值可选，不写值就是缺省值，如果缺省值存在的话

```c
a: i32 = 1
b: i32 ## = 0
c := 1
```

### 类型

#### 基本类型

- i32

#### 类型修饰

- ~

  可变，默认是const，只有加了~才能被修改

- &

  引用，默认是拷贝，加了&就是引用。
  
  引用的工作原理是安全指针，所以请不要啥都引用哦，说不定拷贝性能更好呢，虽然cpp开了优化确实都一样。

- []

  数组，[i32]表示一个的i32数组

  .size()方法可以获取数组大小
  .push_back()方法可以往数组里添加元素

### 表达式

#### 一般表达式

##### 一元运算符

优先级都为11

- \+ 正号
- \- 负号
- ++ 自增
- -- 自减
- ~ 取反
- ! 取非

##### 二元运算符

- 1
  - ==
  - !=
  - <=
  - \>=
- 2
  - ||
- 3
  - &&
- 4
  - \+
  - \-
- 5
  - \*
  - /
  - %
- 6
  - <<
  - \>>
- 7
  - |
- 8
  - &
- 9
  - ^
- 10
  - ** // 暂不能用
- 11
  - ..
- 13
  - .

#### 赋值表达式

入优先级为12，出优先级为0

- =
- ||=
- &&=
- +=
- -=
- *=
- /=
- %=
- <<=
- \>>=
- |=
- &=
- ^=
- ~=
- **= // 暂不能用

### 流控制

#### if

- 表达式?:块儿;
- 表达式?:块儿;语句
- 表达式?:块儿;:块儿;
- 表达式?:块儿;表达式?:块儿;

```c
1==1?:
    print("1==1")
;print("1!=1")

1==2?:
    print("1==2")
;1==3?:
    print("1==3")
;print("1!=3")
```

#### while

- while 表达式:块儿;

```c
while a < 10:
    a = a + 1
;print("成功加到10")
```

#### for

- for 表达式:块儿;
- for 表达式 as name:块儿;

```c
sum := 0
for 0..10 as i:
    print(i)
    sum += i
;print(`sum = {sum}`)
```

#### break

break会从for/while块儿中跳出，且不会执行控制流的后续流

```c
for 0..10 as i:
    if i == 5:break;
;print("我是后续流")
print("我是break后的流")
```
